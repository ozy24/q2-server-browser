<Window x:Class="Q2Browser.Wpf.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:Q2Browser.Wpf.ViewModels"
        xmlns:converters="clr-namespace:Q2Browser.Wpf.Converters"
        mc:Ignorable="d"
        Title="Quake II Server Browser" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <converters:Q2ColorToBrushConverter x:Key="ColorConverter"/>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10" HorizontalAlignment="Left">
            <Button Content="Refresh" Command="{Binding RefreshCommand}" 
                    Width="100" Height="30" Margin="0,0,10,0" 
                    IsEnabled="{Binding IsRefreshing, Converter={StaticResource InverseBooleanConverter}}"/>
            <Button Content="Connect" Command="{Binding ConnectCommand}" 
                    Width="100" Height="30" Margin="0,0,10,0"/>
            <Button Content="Toggle Favorite" Command="{Binding ToggleFavoriteCommand}" 
                    Width="120" Height="30" Margin="0,0,10,0"/>
            <Button Content="Settings" Command="{Binding OpenSettingsCommand}" 
                    Width="100" Height="30" Margin="0,0,10,0"/>
            <Button Content="Diagnostics" Command="{Binding OpenDiagnosticsCommand}" 
                    Width="100" Height="30"/>
        </StackPanel>

        <!-- Search Box -->
        <TextBox Grid.Row="1" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                 Margin="10,5" Height="25" 
                 VerticalContentAlignment="Center"
                 Tag="Search servers..."/>

        <!-- Server List -->
        <DataGrid Grid.Row="2" 
                  ItemsSource="{Binding Servers}"
                  SelectedItem="{Binding SelectedServer}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  SelectionMode="Single"
                  SelectionUnit="FullRow"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling"
                  MouseDoubleClick="DataGrid_MouseDoubleClick"
                  PreviewMouseLeftButtonDown="DataGrid_PreviewMouseLeftButtonDown"
                  Margin="10,5">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Server Name" Binding="{Binding Hostname, Converter={StaticResource ColorConverter}}" Width="*"/>
                <DataGridTextColumn Header="Map" Binding="{Binding Map}" Width="120"/>
                <DataGridTextColumn Header="Mod" Binding="{Binding Mod}" Width="100"/>
                <DataGridTextColumn Header="Players" Binding="{Binding PlayersText}" Width="80"/>
                <DataGridTextColumn Header="Ping" Binding="{Binding PingText}" Width="80"/>
                <DataGridCheckBoxColumn Header="Favorite" Binding="{Binding IsFavorite}" Width="70"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusText}"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock>
                    <Run Text="Servers: "/>
                    <Run Text="{Binding ServersFound}"/>
                </TextBlock>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>

